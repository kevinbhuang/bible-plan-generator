<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A2N Super Awesome Cool Bible Reading Plan Generator 2.0 üí™</title>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        :root {
            --bg-body: #f4f2ee; --bg-panel: #ffffff; --primary: #8aa293;
            --primary-hover: #738a7c; --text-main: #33312e; --text-muted: #8c8984;
            --border: #e6e4df; --success: #8aa293; --warning: #d9b8a2;
            --today-bg: #f9fbf9; --completed-bg: #fcfdfc; --completed-text: #a8a5a0;
        }
        [data-theme="dark"] {
            --bg-body: #1c1b1a; --bg-panel: #262524; --primary: #9bb3a4;
            --text-main: #e8e6e3; --border: #3d3b3a; --today-bg: #2d2f2d;
        }
        body { font-family: 'Georgia', serif; background-color: var(--bg-body); color: var(--text-main); margin: 0; padding: 20px; transition: all 0.4s ease; }
        .container { max-width: 1400px; margin: 0 auto; display: flex; flex-direction: column; gap: 24px; }
        h1 { font-size: 1.75rem; background: var(--bg-panel); padding: 20px 32px; border-radius: 4px; border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .panel { background: var(--bg-panel); padding: 24px 32px; border-radius: 4px; border: 1px solid var(--border); }
        .main-wrapper { display: flex; gap: 24px; align-items: flex-start; }
        .settings-panel { flex: 0 0 320px; position: sticky; top: 20px; }
        .plan-panel { flex: 1; }
        input[type="date"], select, button { padding: 10px; border: 1px solid var(--border); border-radius: 2px; width: 100%; background: var(--bg-body); color: var(--text-main); margin-bottom: 10px; }
        button.primary { background: var(--primary); color: white; font-weight: bold; text-transform: uppercase; border: none; cursor: pointer; padding: 15px; }
        .plan-table { width: 100%; border-collapse: collapse; }
        .plan-table td { padding: 12px; border-bottom: 1px solid var(--border); }
        .completed td { text-decoration: line-through; color: var(--completed-text); background: var(--completed-bg); }
        #secret-muscle { cursor: pointer; user-select: none; display: inline-block; transition: transform 0.1s; }
        .msg-swole { background: #ffebd6; color: #cc5500; border: 2px solid #ffaa44; font-weight: bold; text-align: center; padding: 15px; margin-bottom: 15px; }
        @keyframes shake { 0%, 100% {transform: translate(0,0);} 10%, 30%, 50%, 70%, 90% {transform: translate(-5px,0);} 20%, 40%, 60%, 80% {transform: translate(5px,0);} }
        .shake-active { animation: shake 0.5s ease-in-out 2; }
    </style>
</head>
<body>

<div class="container">
    <h1>
        <span>üìñ A2N Bible Plan <span id="secret-muscle">üí™</span></span>
        <div style="display:flex; align-items:center; gap: 12px;">
            <button id="auth-btn" onclick="handleAuth()" style="width: auto; padding: 8px 16px; border-radius: 20px;">Login for Sync ‚òÅÔ∏è</button>
            <button id="theme-toggle" style="border:none; background:transparent; font-size:1.5rem; cursor:pointer;">üåô</button>
        </div>
    </h1>
    <div id="message-box"></div>

    <div class="main-wrapper">
        <div class="panel settings-panel">
            <label>Start Date</label><input type="date" id="start-date">
            <label>End Date</label><input type="date" id="end-date">
            <label>Strategy</label>
            <select id="balance-strategy">
                <option value="verses">Precision (Verses)</option>
                <option value="even">Even Chapters</option>
            </select>
            <button class="primary" onclick="generateInitialPlan()">Generate Plan</button>
        </div>

        <div class="panel plan-panel" id="plan-section" style="display: none;">
            <div id="progress-text" style="font-weight:bold; margin-bottom:10px;">Progress: 0%</div>
            <table class="plan-table"><tbody id="plan-tbody"></tbody></table>
        </div>
    </div>
</div>

<script>
// --- FIREBASE CONFIG ---
const firebaseConfig = {
    apiKey: "AIzaSyDhPt-S72LKJXAImEjcSpHjdCVTAuWhF1g",
    authDomain: "bible-reading-plan-7ff47.firebaseapp.com",
    projectId: "bible-reading-plan-7ff47",
    storageBucket: "bible-reading-plan-7ff47.firebasestorage.app",
    messagingSenderId: "513219887581",
    appId: "1:513219887581:web:0eb4ed8b17b8f67514b634"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// --- DATA ---
const rawData = [["Genesis", "OT", "Gen", "31,25,24,26,32,22,24,22,29,32,32,20,18,24,21,16,27,33,38,18,34,24,20,67,34,35,46,22,35,43,55,32,20,31,29,43,36,30,23,23,57,38,34,34,28,34,31,22,33,26"], ["Exodus", "OT", "Exod", "22,25,22,31,23,30,25,32,35,29,10,51,22,31,27,36,16,27,25,26,36,31,33,18,40,37,21,43,46,38,18,35,23,35,35,38,29,31,43,38"]]; // Truncated list
const books = rawData.map(r => ({ name: r[0], abbr: r[2], chapters: r[3].split(',').map(Number) }));

let planState = { days: [] };
const DOM = { start: document.getElementById('start-date'), end: document.getElementById('end-date'), tbody: document.getElementById('plan-tbody'), msg: document.getElementById('message-box') };

// --- AUTH & SYNC ---
async function handleAuth() {
    if (auth.currentUser) { await auth.signOut(); location.reload(); } 
    else { await auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()); }
}

auth.onAuthStateChanged(async (user) => {
    const btn = document.getElementById('auth-btn');
    if (user) {
        btn.textContent = `Logout (${user.displayName.split(' ')[0]})`;
        const doc = await db.collection("user_plans").doc(user.uid).get();
        if (doc.exists) { planState = doc.data().planState; renderPlan(); document.getElementById('plan-section').style.display = 'block'; }
    } else { btn.textContent = "Login for Sync ‚òÅÔ∏è"; }
});

async function saveAndRender() {
    renderPlan();
    if (auth.currentUser) { await db.collection("user_plans").doc(auth.currentUser.uid).set({ planState, lastUpdated: firebase.firestore.FieldValue.serverTimestamp() }); }
}

// --- LOGIC ---
function generateInitialPlan() {
    planState.days = [{ date: DOM.start.value, reading: "Genesis 1-3", completed: false }, { date: "Day 2", reading: "Genesis 4-6", completed: false }];
    document.getElementById('plan-section').style.display = 'block';
    saveAndRender();
}

function renderPlan() {
    DOM.tbody.innerHTML = '';
    planState.days.forEach((day, i) => {
        const tr = document.createElement('tr');
        if (day.completed) tr.className = 'completed';
        tr.innerHTML = `<td><input type="checkbox" ${day.completed ? 'checked' : ''} onchange="toggle(${i})"></td><td>${day.date}</td><td>${day.reading}</td>`;
        DOM.tbody.appendChild(tr);
    });
}

function toggle(idx) { planState.days[idx].completed = !planState.days[idx].completed; saveAndRender(); }

// --- EASTER EGG ---
let clicks = 0;
document.getElementById('secret-muscle').onclick = () => {
    if (++clicks === 3) {
        document.body.classList.add('shake-active');
        DOM.msg.innerHTML = `<div class="msg-swole">SPIRITUAL GAINS INCOMING! üí™üî•</div>`;
        setTimeout(() => { document.body.classList.remove('shake-active'); DOM.msg.innerHTML = ''; clicks = 0; }, 2000);
    }
};
</script>
</body>
</html>
